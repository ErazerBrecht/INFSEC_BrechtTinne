#02012016

Doel van vandaag is om via een backdoor de controle te kunnen overnemen van ons victim. We zullen dit doen via Metasploit. Ook willen we dat de hack werkt in alle browsers (niet zoals vorig keer enkel IE).

Hoe gaan we dit doen? We zullen via een DNS spoof wijsmaken dat elke hostname zich bevind op het ip adres van de hacker! Dit doen we door middel van een MITM (Arp spoof). Elke keer de victim vraagt waar bevind google.com, facebook.be, ... zich antwoorden we dus. 

Tegelijk hosten we een website op de hacker (Kali PC), deze zal de victim zien op elke "site"! Op deze site zetten we een valse waarschuwing over niet up ge date systeem! We maken hem wijs dat we uit voorzorg de internettoegang ontzegd hebben. We bieden een update die zogezegd een oplossing biedt, maar eigenlijk is het een kwaadaarige payload met een backdoor in :)

We hebben dit eerst geprobeerd met MITMf, die zou ook een DNS spoof module moeten bevatten. [Dit is een blogpost](http://sign0f4.blogspot.be/2014/07/mitmf-update-spoof-plugin_23.html) die geschreven is door de maker van MITMf. Volgens mij is het gewoon verrouderd, want uiteraard werkt dit niet... Getest op apt-get versie en met de laatste versie op GitHub.

Heb ik maar besloten op Ettercap te gebruiken. We hebben nu geen nood om HTTPS te omzeilen. We gaan immers geen bestaande sites bezoeken. En we vallen een Windows XP computer aan met Firefox 12 / Internet Explorer 8. Dus geen nood om HSTS te omzeilen!

We hebben een paar tuturials gevolgd maar uiteraard werkte er enkele. [Deze video](https://www.youtube.com/watch?v=5xoFFIcUaIA) is diegene met de beste uitleg, staan enkele fouten in zoals de instellingen van etter.conf zijn niet nodig. Deze zijn enkel nodig wil je dat de victim nog de sites kan bezoeken, bij ons is dit niet nodig we serveren onze eigen site. 

Het grootte probleem was dat ik niet beschikte over het etter.dns bestand. Ik dacht geen probleem het niet dat ik het ging gebruiken (alles moet naar mijn computer, er moet dus maar 1 DNS entry in). Maar na alles juist in te stellen werkte het uiteraard niet.

Dan heb ik besloten om Ettercap te gebruiken via de terminal. Maar al snel was duidelijk dat de meeste tuturials out dated waren, commando's die niet meer werken of anders moesten gebruikt worden...

Ik ben ondertussen de tel kwijt geraakt hoevaak "werkende" tuturials niet werken bij ons. Blijkbaar is documentatie en compatibiliteit met oudere versies houden niet zo belangrijk. Ik (Brecht Carlier) was van plan hierover te bloggen, maar ik ben dit gewoon niet meer van plan. Als iemand binnen een jaar mijn post leest, is hij waarschijnlijk totaal niet meer correct....

Ik heb hierna besloten Ettercap te verwijderen *apt-get remove ettercap-common* om hierna terug te installeren *apt-get install ettercap-common*. Het resultaat de grafische versie van ettercap werkt niet (start niet meer op). Maar geen probleem we waren ervan overtuigd dat het wel ging werken als we de laptop herstarten. Bleek jammer genoeg niet het geval te zijn. Na nog talloze apt-get commando's begon de moed in onze schoenen te zaken. Toen heb ik besloten om via de source code ettercap (GitHub) ettercap te installeren. Er gebeurde iets toen we het opstarten maar daarna had ik nog nooit zoveel errors op één scherm gezien.

We waren het zo beu dat ik gewoon mijn laptop heb uitgezet. We hebben verder gedaan via Virtualbox. Daar hadden we wel al de etter.dns file staan, onze hoop steeg. Na alles juist te doen, werkte het nog steeds niet.

Na 5u verder hebben we letterlijk niets bereikt. We besluiten om even te stoppen dit gaat toch niet verder zo....

Mijn volgende plan was om gewoon volledig Kali opnieuw te installeren op mijn laptop. En ook ineens goed. Alles wat op mijn laptop stond (Windows 10, Windows Server 2012 R2, Linux Mint, Kali) heb ik verwijderd. En enkel Kali opnieuw opgezet. Alles terug geconfigureerd (taal, toetsenbord, ...)  en we waren terug up and running. Alles werkt terug normaal buiten de print screen toets.

Als eerste MITMf terug opnieuw geïnstalleerd (dit moet uiteraard eerst terug werken). En daarna alle stappen van Ettercap opnieuw uitgevoerd. Wonder boven wonder begonnen dinges te werken. Ik gebruikte eerst de standaard etter.dns file. Deze zal indien het IP adres van microsoft.com gevraagd wordt het IP doorsturen van linux.org (trololo). 

activate dns spoof!!

####TODO: 
* 27112015 -> commando's verklaren 
* 29122015 -> verder afmaken
* mail script
* 28122015 -> ether.conf
